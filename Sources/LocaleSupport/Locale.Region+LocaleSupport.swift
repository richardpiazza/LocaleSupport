import Foundation

public extension Locale.Region {
    /// Initializes a `Locale.Region` checking that it matched a _known_ instance.
    init(matching knownIdentifier: String) throws {
        let region = Locale.Region(knownIdentifier)
        guard Self.allCases.contains(region) else {
            throw LocaleSupportError.region(knownIdentifier)
        }

        self = region
    }
    
    /// A localized representation for the identifier using the current `Locale.`
    var localizedName: String? {
        localizedName()
    }

    /// A localized representation for the identifier using the provided `Locale.`
    func localizedName(for locale: Locale = .current) -> String? {
        locale.localizedString(forRegionCode: identifier)
    }
    
    /// An _emoji_ representation of the `Locale.Region`.
    var unicodeFlag: String? {
        // equivalent to UInt32 = 127397
        let base = UnicodeScalar("üá¶").value - UnicodeScalar("A").value
        var symbol = ""
        identifier.unicodeScalars.forEach {
            if let scalar = UnicodeScalar(base + $0.value) {
                symbol.unicodeScalars.append(scalar)
            }
        }
        
        return symbol
    }
}

#if hasFeature(RetroactiveAttribute)
extension Locale.Region: @retroactive Identifiable {
    public var id: String { identifier }
}
#else
extension Locale.Region: Identifiable {
    public var id: String { identifier }
}
#endif

#if hasFeature(RetroactiveAttribute)
extension Locale.Region: @retroactive CaseIterable {
    public static let allCases: [Locale.Region] = [
        .afghanistan,
        .√•landIslands,
        .albania,
        .algeria,
        .americanSamoa,
        .andorra,
        .angola,
        .anguilla,
        .antarctica,
        .antiguaBarbuda,
        .argentina,
        .armenia,
        .aruba,
        .ascensionIsland,
        .australia,
        .austria,
        .azerbaijan,
        .bahamas,
        .bahrain,
        .bangladesh,
        .barbados,
        .belarus,
        .belgium,
        .belize,
        .benin,
        .bermuda,
        .bhutan,
        .bolivia,
        .bosniaHerzegovina,
        .botswana,
        .bouvetIsland,
        .brazil,
        .britishVirginIslands,
        .brunei,
        .bulgaria,
        .burkinaFaso,
        .burundi,
        .cambodia,
        .cameroon,
        .canada,
        .canaryIslands,
        .capeVerde,
        .caribbeanNetherlands,
        .caymanIslands,
        .centralAfricanRepublic,
        .ceutaMelilla,
        .chad,
        .chagosArchipelago,
        .chile,
        .chinaMainland,
        .christmasIsland,
        .clippertonIsland,
        .cocosIslands,
        .colombia,
        .comoros,
        .congoBrazzaville,
        .congoKinshasa,
        .cookIslands,
        .costaRica,
        .c√¥teDIvoire,
        .croatia,
        .cuba,
        .cura√ßao,
        .cyprus,
        .czechia,
        .denmark,
        .diegoGarcia,
        .djibouti,
        .dominica,
        .dominicanRepublic,
        .ecuador,
        .egypt,
        .elSalvador,
        .equatorialGuinea,
        .eritrea,
        .estonia,
        .eswatini,
        .ethiopia,
        .falklandIslands,
        .faroeIslands,
        .fiji,
        .finland,
        .france,
        .frenchGuiana,
        .frenchPolynesia,
        .frenchSouthernTerritories,
        .gabon,
        .gambia,
        .georgia,
        .germany,
        .ghana,
        .gibraltar,
        .greece,
        .greenland,
        .grenada,
        .guadeloupe,
        .guam,
        .guatemala,
        .guernsey,
        .guinea,
        .guineaBissau,
        .guyana,
        .haiti,
        .heardMcdonaldIslands,
        .honduras,
        .hongKong,
        .hungary,
        .iceland,
        .india,
        .indonesia,
        .iran,
        .iraq,
        .ireland,
        .isleOfMan,
        .israel,
        .italy,
        .jamaica,
        .japan,
        .jersey,
        .jordan,
        .kazakhstan,
        .kenya,
        .kiribati,
        .kosovo,
        .kuwait,
        .kyrgyzstan,
        .laos,
        .latvia,
        .lebanon,
        .lesotho,
        .liberia,
        .libya,
        .liechtenstein,
        .lithuania,
        .luxembourg,
        .macao,
        .madagascar,
        .malawi,
        .malaysia,
        .maldives,
        .mali,
        .malta,
        .marshallIslands,
        .martinique,
        .mauritania,
        .mauritius,
        .mayotte,
        .mexico,
        .micronesia,
        .moldova,
        .monaco,
        .mongolia,
        .montenegro,
        .montserrat,
        .morocco,
        .mozambique,
        .myanmar,
        .namibia,
        .nauru,
        .nepal,
        .netherlands,
        .newCaledonia,
        .newZealand,
        .nicaragua,
        .niger,
        .nigeria,
        .niue,
        .norfolkIsland,
        .northernMarianaIslands,
        .northMacedonia,
        .norway,
        .oman,
        .pakistan,
        .palau,
        .palestinianTerritories,
        .panama,
        .papuaNewGuinea,
        .paraguay,
        .peru,
        .philippines,
        .pitcairnIslands,
        .poland,
        .portugal,
        .puertoRico,
        .qatar,
        .r√©union,
        .romania,
        .russia,
        .rwanda,
        .saintBarth√©lemy,
        .saintHelena,
        .saintKittsNevis,
        .saintLucia,
        .saintMartin,
        .saintPierreMiquelon,
        .saintVincentGrenadines,
        .samoa,
        .sanMarino,
        .s√£oTom√©Pr√≠ncipe,
        .saudiArabia,
        .senegal,
        .serbia,
        .seychelles,
        .sierraLeone,
        .singapore,
        .sintMaarten,
        .slovakia,
        .slovenia,
        .solomonIslands,
        .somalia,
        .southAfrica,
        .southGeorgiaSouthSandwichIslands,
        .southKorea,
        .southSudan,
        .spain,
        .sriLanka,
        .suriname,
        .svalbardJanMayen,
        .sweden,
        .switzerland,
        .taiwan,
        .tajikistan,
        .tanzania,
        .thailand,
        .timorLeste,
        .togo,
        .tokelau,
        .tonga,
        .trinidadTobago,
        .tristanDaCunha,
        .tunisia,
        .turkey,
        .turkmenistan,
        .turksCaicosIslands,
        .tuvalu,
        .uganda,
        .ukraine,
        .unitedArabEmirates,
        .unitedKingdom,
        .unitedStates,
        .unitedStatesOutlyingIslands,
        .unitedStatesVirginIslands,
        .uruguay,
        .uzbekistan,
        .vanuatu,
        .vaticanCity,
        .venezuela,
        .vietnam,
        .wallisFutuna,
        .westernSahara,
        .yemen,
        .zambia,
        .zimbabwe,
        .world,
        .latinAmerica,
    ]
}
#else
extension Locale.Region: CaseIterable {
    public static let allCases: [Locale.Region] = [
        .afghanistan,
        .√•landIslands,
        .albania,
        .algeria,
        .americanSamoa,
        .andorra,
        .angola,
        .anguilla,
        .antarctica,
        .antiguaBarbuda,
        .argentina,
        .armenia,
        .aruba,
        .ascensionIsland,
        .australia,
        .austria,
        .azerbaijan,
        .bahamas,
        .bahrain,
        .bangladesh,
        .barbados,
        .belarus,
        .belgium,
        .belize,
        .benin,
        .bermuda,
        .bhutan,
        .bolivia,
        .bosniaHerzegovina,
        .botswana,
        .bouvetIsland,
        .brazil,
        .britishVirginIslands,
        .brunei,
        .bulgaria,
        .burkinaFaso,
        .burundi,
        .cambodia,
        .cameroon,
        .canada,
        .canaryIslands,
        .capeVerde,
        .caribbeanNetherlands,
        .caymanIslands,
        .centralAfricanRepublic,
        .ceutaMelilla,
        .chad,
        .chagosArchipelago,
        .chile,
        .chinaMainland,
        .christmasIsland,
        .clippertonIsland,
        .cocosIslands,
        .colombia,
        .comoros,
        .congoBrazzaville,
        .congoKinshasa,
        .cookIslands,
        .costaRica,
        .c√¥teDIvoire,
        .croatia,
        .cuba,
        .cura√ßao,
        .cyprus,
        .czechia,
        .denmark,
        .diegoGarcia,
        .djibouti,
        .dominica,
        .dominicanRepublic,
        .ecuador,
        .egypt,
        .elSalvador,
        .equatorialGuinea,
        .eritrea,
        .estonia,
        .eswatini,
        .ethiopia,
        .falklandIslands,
        .faroeIslands,
        .fiji,
        .finland,
        .france,
        .frenchGuiana,
        .frenchPolynesia,
        .frenchSouthernTerritories,
        .gabon,
        .gambia,
        .georgia,
        .germany,
        .ghana,
        .gibraltar,
        .greece,
        .greenland,
        .grenada,
        .guadeloupe,
        .guam,
        .guatemala,
        .guernsey,
        .guinea,
        .guineaBissau,
        .guyana,
        .haiti,
        .heardMcdonaldIslands,
        .honduras,
        .hongKong,
        .hungary,
        .iceland,
        .india,
        .indonesia,
        .iran,
        .iraq,
        .ireland,
        .isleOfMan,
        .israel,
        .italy,
        .jamaica,
        .japan,
        .jersey,
        .jordan,
        .kazakhstan,
        .kenya,
        .kiribati,
        .kosovo,
        .kuwait,
        .kyrgyzstan,
        .laos,
        .latvia,
        .lebanon,
        .lesotho,
        .liberia,
        .libya,
        .liechtenstein,
        .lithuania,
        .luxembourg,
        .macao,
        .madagascar,
        .malawi,
        .malaysia,
        .maldives,
        .mali,
        .malta,
        .marshallIslands,
        .martinique,
        .mauritania,
        .mauritius,
        .mayotte,
        .mexico,
        .micronesia,
        .moldova,
        .monaco,
        .mongolia,
        .montenegro,
        .montserrat,
        .morocco,
        .mozambique,
        .myanmar,
        .namibia,
        .nauru,
        .nepal,
        .netherlands,
        .newCaledonia,
        .newZealand,
        .nicaragua,
        .niger,
        .nigeria,
        .niue,
        .norfolkIsland,
        .northernMarianaIslands,
        .northMacedonia,
        .norway,
        .oman,
        .pakistan,
        .palau,
        .palestinianTerritories,
        .panama,
        .papuaNewGuinea,
        .paraguay,
        .peru,
        .philippines,
        .pitcairnIslands,
        .poland,
        .portugal,
        .puertoRico,
        .qatar,
        .r√©union,
        .romania,
        .russia,
        .rwanda,
        .saintBarth√©lemy,
        .saintHelena,
        .saintKittsNevis,
        .saintLucia,
        .saintMartin,
        .saintPierreMiquelon,
        .saintVincentGrenadines,
        .samoa,
        .sanMarino,
        .s√£oTom√©Pr√≠ncipe,
        .saudiArabia,
        .senegal,
        .serbia,
        .seychelles,
        .sierraLeone,
        .singapore,
        .sintMaarten,
        .slovakia,
        .slovenia,
        .solomonIslands,
        .somalia,
        .southAfrica,
        .southGeorgiaSouthSandwichIslands,
        .southKorea,
        .southSudan,
        .spain,
        .sriLanka,
        .suriname,
        .svalbardJanMayen,
        .sweden,
        .switzerland,
        .taiwan,
        .tajikistan,
        .tanzania,
        .thailand,
        .timorLeste,
        .togo,
        .tokelau,
        .tonga,
        .trinidadTobago,
        .tristanDaCunha,
        .tunisia,
        .turkey,
        .turkmenistan,
        .turksCaicosIslands,
        .tuvalu,
        .uganda,
        .ukraine,
        .unitedArabEmirates,
        .unitedKingdom,
        .unitedStates,
        .unitedStatesOutlyingIslands,
        .unitedStatesVirginIslands,
        .uruguay,
        .uzbekistan,
        .vanuatu,
        .vaticanCity,
        .venezuela,
        .vietnam,
        .wallisFutuna,
        .westernSahara,
        .yemen,
        .zambia,
        .zimbabwe,
        .world,
        .latinAmerica,
    ]
}
#endif
